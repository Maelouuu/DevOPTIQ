<!-- Code/routes/templates/activity_aptitudes.html -->

<div class="aptitudes-section">
    <div id="aptitudes-container-{{ activity.id }}">
      <!-- Bouton proposer aptitudes en premier -->
      <div class="section-actions-top">
        <button class="btn-modal-primary-propose" onclick="showProposedAptitudes('{{ activity.id }}')">
          <i class="fa-solid fa-sparkles"></i> Proposer Aptitudes
        </button>
      </div>

      {% if activity.aptitudes and activity.aptitudes|length > 0 %}
        <ul class="items-list">
          {% for ap in activity.aptitudes %}
            <li id="aptitude-{{ ap.id }}" class="sf-item">
              <!-- Mode affichage -->
              <div id="apt-display-{{ ap.id }}" class="sf-display">
                <span class="sf-text">{{ ap.description }}</span>
                <button
                  class="icon-btn edit-aptitude-btn"
                  data-aptitude='{{ {"id": ap.id, "description": ap.description}|tojson|safe }}'
                  onclick="showEditAptitudeForm(this)"
                >
                  <i class="fa-solid fa-pencil"></i>
                </button>
                <button class="icon-btn icon-btn-danger" onclick="deleteAptitude('{{ activity.id }}','{{ ap.id }}')">
                  <i class="fa-solid fa-trash"></i>
                </button>
              </div>

              <!-- Mode édition -->
              <div class="sf-edit-area" id="edit-aptitude-form-{{ ap.id }}" style="display:none;">
                <input type="text" class="sf-input" id="edit-aptitude-input-{{ ap.id }}" />
                <button class="icon-btn icon-btn-success" onclick="submitEditAptitude('{{ activity.id }}','{{ ap.id }}')">
                  <i class="fa-solid fa-check"></i>
                </button>
                <button class="icon-btn" onclick="hideEditAptitudeForm('{{ ap.id }}')">
                  <i class="fa-solid fa-xmark"></i>
                </button>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="empty-text">Aucune aptitude enregistrée.</p>
      {% endif %}

      <div class="add-item-section">
        <button class="btn-modal-primary-propose" onclick="showAddAptitudeForm('{{ activity.id }}')">
          <i class="fa-solid fa-plus"></i> Ajouter une Aptitude
        </button>
        <div id="add-aptitude-form-{{ activity.id }}" class="inline-add-form" style="display:none;">
          <input type="text" class="sf-input" id="add-aptitude-input-{{ activity.id }}" placeholder="Description de l'aptitude" />
          <button class="icon-btn icon-btn-success" onclick="submitAddAptitude('{{ activity.id }}')">
            <i class="fa-solid fa-check"></i>
          </button>
          <button class="icon-btn" onclick="hideAddAptitudeForm('{{ activity.id }}')">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
      </div>
    </div>

    <script src="{{ url_for('static', filename='js/propose_aptitudes.js') }}"></script>
    <script src="{{ url_for('static', filename='js/competences_crud.js') }}"></script>
</div>

{% include 'aptitudes_modal.html' %}